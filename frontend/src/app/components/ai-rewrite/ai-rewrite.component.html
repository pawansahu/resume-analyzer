<mat-card class="ai-rewrite-card">
  <mat-card-header>
    <mat-card-title>
      <mat-icon>auto_awesome</mat-icon>
      AI-Powered Rewrite Suggestions
    </mat-card-title>
  </mat-card-header>

  <mat-card-content>
    <!-- Premium Feature Notice -->
    <div *ngIf="!isPremium" class="premium-notice">
      <mat-icon>lock</mat-icon>
      <p>This is a premium feature. Upgrade to access AI-powered suggestions.</p>
      <button mat-raised-button color="primary" (click)="showUpgradePrompt()">
        Upgrade Now
      </button>
    </div>

    <!-- Generate Button -->
    <div class="action-section" *ngIf="isPremium">
      <button 
        mat-raised-button 
        color="primary" 
        (click)="rewriteContent()"
        [disabled]="loading || (mode === 'bullets' && bulletPoints.length === 0) || (mode === 'summary' && !summary)"
      >
        <mat-icon>auto_awesome</mat-icon>
        Generate AI Suggestions
      </button>
      <p class="hint">This may take up to 30 seconds</p>
    </div>

    <!-- Loading Indicator -->
    <div *ngIf="loading" class="loading-section">
      <mat-spinner diameter="50"></mat-spinner>
      <p>Generating AI suggestions... This may take up to 30 seconds.</p>
    </div>

    <!-- Bullet Points Rewrites -->
    <div *ngIf="!loading && mode === 'bullets' && rewrites.length > 0" class="rewrites-section">
      <h3>AI Suggestions</h3>
      
      <div *ngFor="let rewrite of rewrites; let i = index" class="rewrite-item">
        <div class="original-section">
          <h4>Original:</h4>
          <p class="original-text">{{ rewrite.original }}</p>
        </div>

        <div class="suggestions-section">
          <h4>Suggestions:</h4>
          <div *ngFor="let suggestion of rewrite.suggestions; let j = index" 
               class="suggestion-item"
               [class.selected]="isSelected(rewrite.original, suggestion)">
            <div class="suggestion-header">
              <span class="suggestion-number">Option {{ j + 1 }}</span>
              <div class="suggestion-actions">
                <button 
                  mat-icon-button 
                  (click)="selectSuggestion(rewrite.original, suggestion)"
                  [color]="isSelected(rewrite.original, suggestion) ? 'primary' : ''"
                  matTooltip="Select this suggestion"
                >
                  <mat-icon>{{ isSelected(rewrite.original, suggestion) ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
                </button>
                <button 
                  mat-icon-button 
                  (click)="copyToClipboard(suggestion)"
                  matTooltip="Copy to clipboard"
                >
                  <mat-icon>content_copy</mat-icon>
                </button>
              </div>
            </div>
            <p class="suggestion-text" [class]="getDiffClass(rewrite.original, suggestion)">
              {{ suggestion }}
            </p>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary Rewrites -->
    <div *ngIf="!loading && mode === 'summary' && summaries.length > 0" class="summaries-section">
      <h3>AI Suggestions</h3>
      
      <div class="original-section">
        <h4>Original:</h4>
        <p class="original-text">{{ summary }}</p>
      </div>

      <div class="suggestions-section">
        <h4>Suggestions:</h4>
        <div *ngFor="let summaryText of summaries; let i = index" 
             class="suggestion-item"
             [class.selected]="isSelected(summary, summaryText)">
          <div class="suggestion-header">
            <span class="suggestion-number">Version {{ i + 1 }}</span>
            <div class="suggestion-actions">
              <button 
                mat-icon-button 
                (click)="selectSuggestion(summary, summaryText)"
                [color]="isSelected(summary, summaryText) ? 'primary' : ''"
                matTooltip="Select this version"
              >
                <mat-icon>{{ isSelected(summary, summaryText) ? 'check_circle' : 'radio_button_unchecked' }}</mat-icon>
              </button>
              <button 
                mat-icon-button 
                (click)="copyToClipboard(summaryText)"
                matTooltip="Copy to clipboard"
              >
                <mat-icon>content_copy</mat-icon>
              </button>
            </div>
          </div>
          <p class="suggestion-text" [class]="getDiffClass(summary, summaryText)">
            {{ summaryText }}
          </p>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="!loading && rewrites.length === 0 && summaries.length === 0 && isPremium" class="empty-state">
      <mat-icon>lightbulb_outline</mat-icon>
      <p>Click "Generate AI Suggestions" to get started</p>
    </div>
  </mat-card-content>
</mat-card>
